# ãƒªãƒã‚¸ãƒˆãƒªå¥å…¨æ€§åˆ†æãƒ¬ãƒãƒ¼ãƒˆ

**åˆ†ææ—¥**: 2026å¹´1æœˆ29æ—¥  
**å¯¾è±¡ãƒªãƒã‚¸ãƒˆãƒª**: fc-demand-forecast

---

## ğŸ“Š ã‚µãƒãƒªãƒ¼

| ã‚«ãƒ†ã‚´ãƒª | ğŸ”´ å³åº§å¯¾å¿œ | ğŸŸ¡ æ”¹å–„æ¨å¥¨ | ğŸŸ¢ å‚è€ƒæƒ…å ± |
|---------|-----------|-----------|-----------|
| æœªä½¿ç”¨ã‚³ãƒ¼ãƒ‰ | 4ä»¶ | 2ä»¶ | - |
| è¤‡é›‘åº¦ | 2ä»¶ | 3ä»¶ | - |
| ä¾å­˜é–¢ä¿‚ | 1ä»¶ | 1ä»¶ | - |
| é‡è¤‡ã‚³ãƒ¼ãƒ‰ | - | 2ä»¶ | - |

---

## 1. æœªä½¿ç”¨ã‚³ãƒ¼ãƒ‰ã®æ¤œå‡º

### ğŸ”´ å³åº§ã«å¯¾å¿œã™ã¹ãå•é¡Œ

#### 1.1 æœªä½¿ç”¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰

| ãƒ•ã‚¡ã‚¤ãƒ« | è¡Œæ•° | çŠ¶æ…‹ | æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ |
|----------|------|------|---------------|
| `components/StoreSelector.tsx` | 72è¡Œ | **å®Œå…¨æœªä½¿ç”¨** | å‰Šé™¤å¯èƒ½ |
| `components/PeriodSelector.tsx` | 66è¡Œ | **å®Œå…¨æœªä½¿ç”¨** | å‰Šé™¤å¯èƒ½ |
| `components/Loading.tsx` | 18è¡Œ | **å®Œå…¨æœªä½¿ç”¨** | å‰Šé™¤å¯èƒ½ |
| `components/SalesChartModal.tsx` | 236è¡Œ | **å®Œå…¨æœªä½¿ç”¨** | å‰Šé™¤å¯èƒ½ |

**è©³ç´°**:
- `StoreSelector.tsx`: `StorePeriodSelector`ã«çµ±åˆæ¸ˆã¿
- `PeriodSelector.tsx`: `StorePeriodSelector`ã«çµ±åˆæ¸ˆã¿
- `Loading.tsx`: `LoadingProgress`ã«ç½®ãæ›ãˆæ¸ˆã¿
- `SalesChartModal.tsx`: ã‚°ãƒ©ãƒ•æ©Ÿèƒ½å‰Šé™¤ã«ã‚ˆã‚Šä¸è¦

**ä¿®æ­£æ¡ˆ**:
```bash
# å‰Šé™¤å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«
rm frontend/src/components/StoreSelector.tsx
rm frontend/src/components/PeriodSelector.tsx
rm frontend/src/components/Loading.tsx
rm frontend/src/components/SalesChartModal.tsx

# components/index.ts ã‹ã‚‰è©²å½“ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚’å‰Šé™¤
```

#### 1.2 æœªä½¿ç”¨APIé–¢æ•°ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰

| é–¢æ•°å | ãƒ•ã‚¡ã‚¤ãƒ« | çŠ¶æ…‹ |
|--------|----------|------|
| `fetchTableData` | `api/client.ts` | æœªä½¿ç”¨ï¼ˆ`fetchTableDataPaginated`ã®ã¿ä½¿ç”¨ï¼‰ |
| `syncAll` | `api/client.ts` | å®Œå…¨æœªä½¿ç”¨ |

**ä¿®æ­£æ¡ˆ**: 
- `fetchTableData`ã¯`fetchTableDataPaginated`ã®å†…éƒ¨ã§ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ã‹ç¢ºèªå¾Œã€å‰Šé™¤
- `syncAll`ã¯å‰Šé™¤å¯èƒ½

### ğŸŸ¡ æ”¹å–„æ¨å¥¨

#### 1.3 é‡è¤‡å®šç¾©ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | å ´æ‰€ | çŠ¶æ…‹ |
|---------------|------|------|
| `ForecastTooltip` | `components/ForecastTooltip.tsx` | å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦å­˜åœ¨ |
| `ForecastTooltip` | `components/forecast/StepResult.tsx` å†… | ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³å®šç¾©ã§ä½¿ç”¨ä¸­ |

**æ¨å¥¨**: `StepResult.tsx`å†…ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³å®šç¾©ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«`ForecastTooltip.tsx`ã¯å‰Šé™¤å¯èƒ½

---

## 2. è¤‡é›‘åº¦ã®åˆ†æ

### ğŸ”´ å³åº§ã«å¯¾å¿œã™ã¹ãå•é¡Œï¼ˆ100è¡Œä»¥ä¸Šã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

| ãƒ•ã‚¡ã‚¤ãƒ« | è¡Œæ•° | å•é¡Œç‚¹ |
|----------|------|--------|
| `frontend/src/pages/SettingsPage.tsx` | **1,619è¡Œ** | æ¥µã‚ã¦å¤§ãã„ã€‚è¤‡æ•°ã®ã‚¿ãƒ–ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’åˆ†å‰²ã™ã¹ã |
| `backend/src/routes/forecast.ts` | **1,683è¡Œ** | æ¥µã‚ã¦å¤§ãã„ã€‚ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚µãƒ¼ãƒ“ã‚¹å±¤ã«åˆ†é›¢ã™ã¹ã |

**SettingsPage.tsx ã®åˆ†å‰²æ¡ˆ**:
```
pages/
â”œâ”€â”€ SettingsPage.tsx (ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒŠ: ~100è¡Œ)
â””â”€â”€ settings/
    â”œâ”€â”€ StoreSettingsTab.tsx
    â”œâ”€â”€ SupplierSettingsTab.tsx
    â”œâ”€â”€ EmailSettingsTab.tsx
    â””â”€â”€ SystemSettingsTab.tsx
```

**forecast.ts ã®åˆ†å‰²æ¡ˆ**:
```
routes/
â”œâ”€â”€ forecast.ts (ãƒ«ãƒ¼ãƒˆå®šç¾©: ~100è¡Œ)
services/
â”œâ”€â”€ forecast/
â”‚   â”œâ”€â”€ calculator.ts (äºˆæ¸¬è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯)
â”‚   â”œâ”€â”€ abcAnalysis.ts (ABCåˆ†æ)
â”‚   â”œâ”€â”€ anomalyDetection.ts (ç•°å¸¸æ¤œçŸ¥)
â”‚   â””â”€â”€ stockoutCost.ts (æ¬ å“ã‚³ã‚¹ãƒˆè¨ˆç®—)
```

### ğŸŸ¡ æ”¹å–„æ¨å¥¨ï¼ˆè¤‡é›‘ãªãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

| ãƒ•ã‚¡ã‚¤ãƒ« | è¡Œæ•° | æ¨å¥¨ |
|----------|------|------|
| `frontend/src/components/forecast/StepResult.tsx` | 1,206è¡Œ | ã‚µãƒ–ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ†é›¢ |
| `backend/src/routes/orders.ts` | 1,351è¡Œ | ã‚µãƒ¼ãƒ“ã‚¹å±¤åˆ†é›¢ |
| `backend/src/services/cache/tableDataCache.ts` | 864è¡Œ | ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°åˆ†é›¢ |

---

## 3. ä¾å­˜é–¢ä¿‚ã®æ•´ç†

### ğŸ”´ å³åº§ã«å¯¾å¿œã™ã¹ãå•é¡Œ

#### 3.1 æœªä½¿ç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰

| ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ | çŠ¶æ…‹ | æ¨å¥¨ |
|-----------|------|------|
| `chart.js` | **å®Œå…¨æœªä½¿ç”¨** | å‰Šé™¤ |
| `react-chartjs-2` | **å®Œå…¨æœªä½¿ç”¨** | å‰Šé™¤ |

**ä¿®æ­£æ¡ˆ**:
```bash
cd frontend
npm uninstall chart.js react-chartjs-2
```

### ğŸŸ¡ æ”¹å–„æ¨å¥¨

#### 3.2 é‡è¤‡ãƒãƒ£ãƒ¼ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒª

| ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ | ä½¿ç”¨çŠ¶æ³ |
|-----------|----------|
| `recharts` | 3ãƒ•ã‚¡ã‚¤ãƒ«ã§ä½¿ç”¨ä¸­ |
| `chart.js` + `react-chartjs-2` | æœªä½¿ç”¨ |

**æ¨å¥¨**: `recharts`ã«çµ±ä¸€æ¸ˆã¿ã€‚`chart.js`é–¢é€£ã¯å‰Šé™¤å¯èƒ½ã€‚

---

## 4. é‡è¤‡ãƒ»é¡ä¼¼ã‚³ãƒ¼ãƒ‰

### ğŸŸ¡ æ”¹å–„æ¨å¥¨

#### 4.1 ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ç®¡ç†ã®é‡è¤‡

ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§é¡ä¼¼ã®ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ç®¡ç†ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒç¹°ã‚Šè¿”ã•ã‚Œã¦ã„ã¾ã™ï¼š

- `pages/SettingsPage.tsx` (4ç®‡æ‰€)
- `pages/OrderAnalyticsPage.tsx`
- `components/forecast/StepStoreSupplier.tsx`

**å…±é€šåŒ–æ¡ˆ**: ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ `useAsyncData` ã‚’ä½œæˆ

```typescript
// hooks/useAsyncData.ts
export function useAsyncData<T>(fetchFn: () => Promise<T>) {
  const [data, setData] = useState<T | null>(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  // ...
}
```

#### 4.2 æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé–¢æ•°ã®é‡è¤‡

| ãƒ•ã‚¡ã‚¤ãƒ« | é–¢æ•° |
|----------|------|
| `StepResult.tsx` | `formatDate()` |
| `OrderHistory.tsx` | æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå‡¦ç† |
| `App.tsx` | `format()` (date-fns) |

**æ¨å¥¨**: `utils/dateUtils.ts` ã«çµ±ä¸€

---

## 5. æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒªã‚¹ãƒˆï¼ˆå„ªå…ˆåº¦é †ï¼‰

### å„ªå…ˆåº¦: é«˜ï¼ˆPhase 2å®Ÿè£…å‰ã«å¯¾å¿œæ¨å¥¨ï¼‰

| # | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ | å½±éŸ¿ | å·¥æ•° |
|---|-----------|------|------|
| 1 | æœªä½¿ç”¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ4ä»¶ã‚’å‰Šé™¤ | ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºå‰Šæ¸› | 10åˆ† |
| 2 | `chart.js`é–¢é€£ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å‰Šé™¤ | ä¾å­˜é–¢ä¿‚æ•´ç† | 5åˆ† |
| 3 | `components/index.ts`ã‹ã‚‰æœªä½¿ç”¨ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚’å‰Šé™¤ | ã‚³ãƒ¼ãƒ‰æ•´ç† | 5åˆ† |
| 4 | `ForecastTooltip.tsx`ï¼ˆå¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã‚’å‰Šé™¤ | é‡è¤‡è§£æ¶ˆ | 5åˆ† |

### å„ªå…ˆåº¦: ä¸­ï¼ˆPhase 2ã¨ä¸¦è¡Œã—ã¦å¯¾å¿œï¼‰

| # | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ | å½±éŸ¿ | å·¥æ•° |
|---|-----------|------|------|
| 5 | `SettingsPage.tsx`ã‚’ã‚¿ãƒ–ã”ã¨ã«åˆ†å‰² | ä¿å®ˆæ€§å‘ä¸Š | 2æ™‚é–“ |
| 6 | `forecast.ts`ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚µãƒ¼ãƒ“ã‚¹å±¤ã«åˆ†é›¢ | ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§å‘ä¸Š | 3æ™‚é–“ |
| 7 | å…±é€šãƒ•ãƒƒã‚¯`useAsyncData`ã‚’ä½œæˆ | ã‚³ãƒ¼ãƒ‰é‡è¤‡å‰Šæ¸› | 1æ™‚é–“ |

### å„ªå…ˆåº¦: ä½ï¼ˆå°†æ¥çš„ã«å¯¾å¿œï¼‰

| # | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ | å½±éŸ¿ | å·¥æ•° |
|---|-----------|------|------|
| 8 | `api/client.ts`ã®æœªä½¿ç”¨é–¢æ•°ã‚’å‰Šé™¤ | ã‚³ãƒ¼ãƒ‰æ•´ç† | 15åˆ† |
| 9 | æ—¥ä»˜ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’çµ±ä¸€ | ä¸€è²«æ€§å‘ä¸Š | 30åˆ† |
| 10 | `debug.ts`ã‚’æœ¬ç•ªç’°å¢ƒã§ç„¡åŠ¹åŒ– | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ | 15åˆ† |

---

## 6. ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºä¸€è¦§

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆä¸Šä½10ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

| ãƒ•ã‚¡ã‚¤ãƒ« | è¡Œæ•° | çŠ¶æ…‹ |
|----------|------|------|
| SettingsPage.tsx | 1,619 | âš ï¸ è¦åˆ†å‰² |
| StepResult.tsx | 1,206 | âš ï¸ è¦åˆ†å‰² |
| OrderHistory.tsx | 719 | è¨±å®¹ç¯„å›² |
| App.tsx | 621 | è¨±å®¹ç¯„å›² |
| DataTable.tsx | 477 | è¨±å®¹ç¯„å›² |
| OrderAnalyticsPage.tsx | 468 | è¨±å®¹ç¯„å›² |
| OrderSummary.tsx | 360 | è¨±å®¹ç¯„å›² |
| DemandForecast.tsx | 338 | è¨±å®¹ç¯„å›² |
| StepStoreSupplier.tsx | 301 | è¨±å®¹ç¯„å›² |
| client.ts | 279 | è¨±å®¹ç¯„å›² |

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆä¸Šä½10ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

| ãƒ•ã‚¡ã‚¤ãƒ« | è¡Œæ•° | çŠ¶æ…‹ |
|----------|------|------|
| forecast.ts | 1,683 | âš ï¸ è¦åˆ†å‰² |
| orders.ts | 1,351 | âš ï¸ è¦åˆ†å‰² |
| tableDataCache.ts | 864 | è¨±å®¹ç¯„å›² |
| suppliers.ts | 424 | è¨±å®¹ç¯„å›² |
| settings.ts | 406 | è¨±å®¹ç¯„å›² |
| analytics.ts | 372 | è¨±å®¹ç¯„å›² |
| sync.ts | 361 | è¨±å®¹ç¯„å›² |
| mailer.ts | 270 | è¨±å®¹ç¯„å›² |
| index.ts | 215 | è¨±å®¹ç¯„å›² |
| sales.ts (smaregi) | 208 | è¨±å®¹ç¯„å›² |

---

## 7. å³æ™‚å®Ÿè¡Œå¯èƒ½ãªã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§å„ªå…ˆåº¦ã€Œé«˜ã€ã®é …ç›®ã‚’ä¸€æ‹¬å¯¾å¿œã§ãã¾ã™ï¼š

```bash
# 1. æœªä½¿ç”¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å‰Šé™¤
cd /home/ubuntu/fc-demand-forecast
rm frontend/src/components/StoreSelector.tsx
rm frontend/src/components/PeriodSelector.tsx
rm frontend/src/components/Loading.tsx
rm frontend/src/components/SalesChartModal.tsx
rm frontend/src/components/ForecastTooltip.tsx

# 2. æœªä½¿ç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å‰Šé™¤
cd frontend
npm uninstall chart.js react-chartjs-2

# 3. components/index.ts ã‚’æ›´æ–°ï¼ˆæ‰‹å‹•ç·¨é›†ãŒå¿…è¦ï¼‰
# ä»¥ä¸‹ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚’å‰Šé™¤:
# - export { StoreSelector } from './StoreSelector';
# - export { PeriodSelector } from './PeriodSelector';
# - export { Loading } from './Loading';
# - export { SalesChartModal } from './SalesChartModal';

# 4. ãƒ“ãƒ«ãƒ‰ç¢ºèª
npm run build
```

---

## 8. çµè«–

ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã¯æ©Ÿèƒ½çš„ã«ã¯å•é¡Œãªãå‹•ä½œã—ã¦ã„ã¾ã™ãŒã€ä»¥ä¸‹ã®ç‚¹ã§æ”¹å–„ã®ä½™åœ°ãŒã‚ã‚Šã¾ã™ï¼š

1. **æœªä½¿ç”¨ã‚³ãƒ¼ãƒ‰**: ç´„400è¡Œã®å‰Šé™¤å¯èƒ½ãªã‚³ãƒ¼ãƒ‰ãŒå­˜åœ¨
2. **å¤§è¦æ¨¡ãƒ•ã‚¡ã‚¤ãƒ«**: 2ãƒ•ã‚¡ã‚¤ãƒ«ãŒ1,500è¡Œã‚’è¶…ãˆã¦ãŠã‚Šã€åˆ†å‰²æ¨å¥¨
3. **ä¾å­˜é–¢ä¿‚**: æœªä½¿ç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒ2ã¤å­˜åœ¨

Phase 2å®Ÿè£…å‰ã«å„ªå…ˆåº¦ã€Œé«˜ã€ã®é …ç›®ï¼ˆç´„25åˆ†ã®ä½œæ¥­ï¼‰ã‚’å¯¾å¿œã™ã‚‹ã“ã¨ã§ã€ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ãŒã‚¯ãƒªãƒ¼ãƒ³ãªçŠ¶æ…‹ã§æ–°æ©Ÿèƒ½é–‹ç™ºã‚’é€²ã‚ã‚‰ã‚Œã¾ã™ã€‚

---

*ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ: Manus AI*
