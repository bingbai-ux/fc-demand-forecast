# Claudeへの指示書：需要予測ロジックの検証

## 1. 目的

現在の需要予測ロジックを改善するため、複数の発注方法をシミュレーションし、最適な組み合わせを特定する。

## 2. 現在の需要予測ロジック

- **予測モデル**: 単純平均（指定された参照期間の総売上 ÷ 参照日数）
- **安全在庫**: `日平均売上 × √予測日数 × 安全在庫係数`
- **安全在庫係数**: 変動係数（CV）に基づいて3段階で設定
  - CV < 0.3 (安定): 0.5
  - 0.3 ≤ CV < 0.6 (中程度): 0.7
  - CV ≥ 0.6 (不安定): 1.0
- **推奨発注数**: `予測売数 + 安全在庫 - 現在庫`

## 3. 検証用データセット

添付の`sales_data.csv`を使用してください。このファイルには、以下の情報が含まれています。

- `productId`: 商品ID
- `productName`: 商品名
- `supplierName`: 仕入先名
- `avgDailySales`: 日平均売上
- `forecastQuantity`: 予測売数
- `currentStock`: 現在庫
- `safetyStock`: 安全在庫
- `recommendedOrder`: 推奨発注数
- `rank`: ABCランク
- `coefficientOfVariation`: 変動係数（CV）
- `pastSalesTotal`: 過去7日間の売上合計

## 4. 検証タスク

### タスク1: 1週間のデータでベストな発注方法を3つに絞る

以下の7つの発注方法をシミュレーションし、**1週間のデータ**（`lookback_days=7`）で最も優れた方法を3つ選定してください。

**発注方法の候補:**
1. **現行ロジック**: 上記のロジック通り
2. **シンプル固定（係数0.7）**: 全商品の安全在庫係数を一律0.7に設定
3. **シンプル固定（係数1.0）**: 全商品の安全在庫係数を一律1.0に設定
4. **ランク重視**: ランクA商品の係数を2.0倍、ランクB商品を1.5倍にする
5. **CV重視**: CV≥0.6の商品の係数を1.5に引き上げる
6. **ランク×CV複合**: ランクとCVの両方を考慮して係数を調整
7. **欠品ゼロ志向**: 全体的に係数を高めに設定（安定:1.0, 中程度:1.5, 不安定:2.0）

**評価基準:**
- **欠品リスク率**: 最も重要な指標。これを最小化する。
- **発注金額合計**: 在庫コストの指標。過度に高くならないようにする。
- **シンプルさ**: 運用しやすいシンプルなロジックを優先する。

### タスク2: 参照期間別の検証

タスク1で選定した**ベスト3の方法**について、以下の参照期間で再度シミュレーションを行い、それぞれの期間でどの方法が最適か評価してください。

- **2週間** (`lookback_days=14`)
- **1ヶ月** (`lookback_days=30`)
- **3ヶ月** (`lookback_days=90`)

### タスク3: 最終的な推奨ロジックの提案

全ての検証結果を総合的に判断し、最もバランスの取れた**最終的な推奨ロジック**（参照期間と安全在庫係数の組み合わせ）を1つ提案してください。

---

添付ファイル: `sales_data.csv`
